-- Sample SQL Queries

CREATE TABLE `tblDump1995` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump1995` ON `tblDump1995` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump1996` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump1996` ON `tblDump1996` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump1997` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump1997` ON `tblDump1997` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump1998` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump1998` ON `tblDump1998` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump1999` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump1999` ON `tblDump1999` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2000` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2000` ON `tblDump2000` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2001` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2001` ON `tblDump2001` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2002` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2002` ON `tblDump2002` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2003` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2003` ON `tblDump2003` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2004` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2004` ON `tblDump2004` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2005` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2005` ON `tblDump2005` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2006` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2006` ON `tblDump2006` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2007` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2007` ON `tblDump2007` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2008` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2008` ON `tblDump2008` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2009` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2009` ON `tblDump2009` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2010` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2010` ON `tblDump2010` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2011` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2011` ON `tblDump2011` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2012` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2012` ON `tblDump2012` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2013` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2013` ON `tblDump2013` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2014` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2014` ON `tblDump2014` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2015` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2015` ON `tblDump2015` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2016` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2016` ON `tblDump2016` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2017` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2017` ON `tblDump2017` ( `Symbol` ASC, `Date` ASC );
CREATE TABLE `tblDump2018` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxDump2018` ON `tblDump2018` ( `Symbol` ASC, `Date` ASC );

CREATE TABLE `tblDuplicates` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER );
CREATE INDEX `idxDuplicates` ON `tblDuplicates` ( `Symbol` ASC, `Date` ASC );

CREATE TABLE `tblSkipped` ( `Symbol` TEXT, `Date` TEXT, `Open` REAL, `High` REAL, `Low` REAL, `Close` REAL, `Volume` INTEGER );
CREATE INDEX `idxSkipped` ON `tblSkipped` ( `Symbol` ASC, `Date` ASC );

CREATE TABLE `tblMultipliers` ( `Symbol` TEXT, `Date` TEXT, `Multiplier` REAL, `ResultantMultiplier` REAL, PRIMARY KEY(`Symbol`,`Date`) );
CREATE UNIQUE INDEX `idxMultipliers` ON `tblMultipliers` ( `Symbol` ASC, `Date` ASC );

-- All symbols counts, max, min dates
select symbol, count(date), min(date), max(date) from (
select symbol, date from tblDump1995
union select symbol, date from tblDump1996
union select symbol, date from tblDump1997
union select symbol, date from tblDump1998
union select symbol, date from tblDump1999
union select symbol, date from tblDump2000
union select symbol, date from tblDump2001
union select symbol, date from tblDump2002
union select symbol, date from tblDump2003
union select symbol, date from tblDump2004
union select symbol, date from tblDump2005
union select symbol, date from tblDump2006
union select symbol, date from tblDump2007
union select symbol, date from tblDump2008
union select symbol, date from tblDump2009
union select symbol, date from tblDump2010
union select symbol, date from tblDump2011
union select symbol, date from tblDump2012
union select symbol, date from tblDump2013
union select symbol, date from tblDump2014
union select symbol, date from tblDump2015
union select symbol, date from tblDump2016
union select symbol, date from tblDump2017
union select symbol, date from tblDump2018) group by symbol


SELECT D.*
                   FROM tblDuplicates D LEFT OUTER JOIN tblSkipped S
                     ON D.Symbol = S.Symbol
                    AND D.Date = S.Date
					AND D.Open = S.Open
					AND D.High = S.High
					AND D.Low = S.Low
					AND D.Close = S.Close
					AND D.Volume = S.Volume
				WHERE S.Symbol is Null

select symbol, date, count(date) count from tblDuplicates group by symbol, date order by count desc